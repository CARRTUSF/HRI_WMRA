function [Je, J07, R08] = DUAL_arm_robot_Jacobian (phi, Q_arm, arm)
[L1,L2,L3,L4,L5] = powerbot_read_parameters();
if(strcmp(arm,'left'))
    L3=L3;
elseif(strcmp(arm,'right'))
    L3=-L3;
else
    disp('input argument error');
    while(1);
    end
end
theta1 =Q_arm(1);
theta2 =Q_arm(2);
theta3 =Q_arm(3);
theta4 =Q_arm(4);
theta5 =Q_arm(5);
theta6 =Q_arm(6);
theta7 =Q_arm(7);

RGA =[cos(phi) -sin(phi) 0; sin(phi) cos(phi) 0; 0 0 1];
RGA_6x6 = [RGA zeros(3); zeros(3) RGA];

Jwh_6D =[
    (L5*(cos(phi) + (2*L3*cos(phi) + 2*L2*sin(phi))/L1))/2, (L5*(cos(phi) - (2*L3*cos(phi) + 2*L2*sin(phi))/L1))/2;
    (L5*(sin(phi) - (2*L2*cos(phi) - 2*L3*sin(phi))/L1))/2, (L5*(sin(phi) + (2*L2*cos(phi) - 2*L3*sin(phi))/L1))/2;
    0,                                                      0;
    0,                                                      0;
    0,                                                      0;
    -L5/L1,                                                  L5/L1
    ];


J07 =[
    - 69*sin(theta1) - 69*cos(theta1)*sin(theta3) - (7287*sin(theta1)*sin(theta2))/20 - 10*cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) - 280*cos(theta6)*(sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2)) - (37429*sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)))/100 - 10*sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)) - 280*sin(theta6)*(cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3))) - (37429*cos(theta4)*sin(theta1)*sin(theta2))/100 - 69*cos(theta2)*cos(theta3)*sin(theta1), -(cos(theta1)*(6900*cos(theta3)*sin(theta2) - 37429*cos(theta2)*cos(theta4) - 36435*cos(theta2) + 37429*cos(theta3)*sin(theta2)*sin(theta4) - 1000*sin(theta2)*sin(theta3)*sin(theta5) - 28000*cos(theta2)*cos(theta4)*cos(theta6) + 1000*cos(theta2)*cos(theta5)*sin(theta4) + 1000*cos(theta3)*cos(theta4)*cos(theta5)*sin(theta2) + 28000*cos(theta3)*cos(theta6)*sin(theta2)*sin(theta4) + 28000*cos(theta2)*cos(theta5)*sin(theta4)*sin(theta6) - 28000*sin(theta2)*sin(theta3)*sin(theta5)*sin(theta6) + 28000*cos(theta3)*cos(theta4)*cos(theta5)*sin(theta2)*sin(theta6)))/100, 10*sin(theta5)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - (37429*sin(theta4)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)))/100 - 69*cos(theta3)*sin(theta1) + 280*sin(theta6)*(sin(theta5)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta4)*cos(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3))) - 10*cos(theta4)*cos(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)) - 280*cos(theta6)*sin(theta4)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)) - 69*cos(theta1)*cos(theta2)*sin(theta3), 10*cos(theta5)*(sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta1)*cos(theta4)*sin(theta2)) - 280*cos(theta6)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) - (37429*cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)))/100 - (37429*cos(theta1)*sin(theta2)*sin(theta4))/100 + 280*cos(theta5)*sin(theta6)*(sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta1)*cos(theta4)*sin(theta2)), -10*(28*sin(theta6) + 1)*(cos(theta3)*cos(theta5)*sin(theta1) + cos(theta1)*cos(theta2)*cos(theta5)*sin(theta3) - cos(theta1)*sin(theta2)*sin(theta4)*sin(theta5) - cos(theta4)*sin(theta1)*sin(theta3)*sin(theta5) + cos(theta1)*cos(theta2)*cos(theta3)*cos(theta4)*sin(theta5)), 280*sin(theta6)*(sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta1)*cos(theta4)*sin(theta2)) - 280*cos(theta6)*(cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3))),                                                                                                                                                                                                                                                                                                                                                               0;
    69*cos(theta1) + (7287*cos(theta1)*sin(theta2))/20 - 69*sin(theta1)*sin(theta3) - 10*cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) - 280*cos(theta6)*(sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta1)*cos(theta4)*sin(theta2)) - 280*sin(theta6)*(cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3))) - (37429*sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)))/100 - 10*sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)) + 69*cos(theta1)*cos(theta2)*cos(theta3) + (37429*cos(theta1)*cos(theta4)*sin(theta2))/100, -(sin(theta1)*(6900*cos(theta3)*sin(theta2) - 37429*cos(theta2)*cos(theta4) - 36435*cos(theta2) + 37429*cos(theta3)*sin(theta2)*sin(theta4) - 1000*sin(theta2)*sin(theta3)*sin(theta5) - 28000*cos(theta2)*cos(theta4)*cos(theta6) + 1000*cos(theta2)*cos(theta5)*sin(theta4) + 1000*cos(theta3)*cos(theta4)*cos(theta5)*sin(theta2) + 28000*cos(theta3)*cos(theta6)*sin(theta2)*sin(theta4) + 28000*cos(theta2)*cos(theta5)*sin(theta4)*sin(theta6) - 28000*sin(theta2)*sin(theta3)*sin(theta5)*sin(theta6) + 28000*cos(theta3)*cos(theta4)*cos(theta5)*sin(theta2)*sin(theta6)))/100, 69*cos(theta1)*cos(theta3) + (37429*sin(theta4)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)))/100 - 10*sin(theta5)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - 280*sin(theta6)*(sin(theta5)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - cos(theta4)*cos(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3))) - 69*cos(theta2)*sin(theta1)*sin(theta3) + 10*cos(theta4)*cos(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)) + 280*cos(theta6)*sin(theta4)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)), 280*cos(theta6)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) - 10*cos(theta5)*(sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2)) + (37429*cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)))/100 - (37429*sin(theta1)*sin(theta2)*sin(theta4))/100 - 280*cos(theta5)*sin(theta6)*(sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2)), -10*(28*sin(theta6) + 1)*(cos(theta2)*cos(theta5)*sin(theta1)*sin(theta3) - cos(theta1)*cos(theta3)*cos(theta5) + cos(theta1)*cos(theta4)*sin(theta3)*sin(theta5) - sin(theta1)*sin(theta2)*sin(theta4)*sin(theta5) + cos(theta2)*cos(theta3)*cos(theta4)*sin(theta1)*sin(theta5)), 280*cos(theta6)*(cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3))) - 280*sin(theta6)*(sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2)),                                                                                                                                                                                                                                                                                                                                                               0;
    0,                                                                                           280*sin(theta6)*(cos(theta5)*(sin(theta2)*sin(theta4) - cos(theta2)*cos(theta3)*cos(theta4)) + cos(theta2)*sin(theta3)*sin(theta5)) - 69*cos(theta2)*cos(theta3) - (37429*cos(theta4)*sin(theta2))/100 - (7287*sin(theta2))/20 + 10*cos(theta5)*(sin(theta2)*sin(theta4) - cos(theta2)*cos(theta3)*cos(theta4)) - 280*cos(theta6)*(cos(theta4)*sin(theta2) + cos(theta2)*cos(theta3)*sin(theta4)) + 10*cos(theta2)*sin(theta3)*sin(theta5) - (37429*cos(theta2)*cos(theta3)*sin(theta4))/100,                                                                                                                                                                                                                                                                                                                                      (sin(theta2)*(6900*sin(theta3) + 1000*cos(theta3)*sin(theta5) + 37429*sin(theta3)*sin(theta4) + 28000*cos(theta6)*sin(theta3)*sin(theta4) + 28000*cos(theta3)*sin(theta5)*sin(theta6) + 1000*cos(theta4)*cos(theta5)*sin(theta3) + 28000*cos(theta4)*cos(theta5)*sin(theta3)*sin(theta6)))/100,                                                                                                                                                                                                               - (37429*cos(theta2)*sin(theta4))/100 - 10*cos(theta5)*(cos(theta2)*cos(theta4) - cos(theta3)*sin(theta2)*sin(theta4)) - 280*cos(theta6)*(cos(theta2)*sin(theta4) + cos(theta3)*cos(theta4)*sin(theta2)) - 280*cos(theta5)*sin(theta6)*(cos(theta2)*cos(theta4) - cos(theta3)*sin(theta2)*sin(theta4)) - (37429*cos(theta3)*cos(theta4)*sin(theta2))/100,                                                                                                                              10*(28*sin(theta6) + 1)*(cos(theta5)*sin(theta2)*sin(theta3) + cos(theta2)*sin(theta4)*sin(theta5) + cos(theta3)*cos(theta4)*sin(theta2)*sin(theta5)),                                                                                                                                               - 280*cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) + cos(theta3)*cos(theta4)*sin(theta2)) - sin(theta2)*sin(theta3)*sin(theta5)) - 280*sin(theta6)*(cos(theta2)*cos(theta4) - cos(theta3)*sin(theta2)*sin(theta4)),                                                                                                                                                                                                                                                                                                                                                               0;
    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           -sin(theta1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             cos(theta1)*sin(theta2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        - cos(theta3)*sin(theta1) - cos(theta1)*cos(theta2)*sin(theta3),                                                                                                                                                                  cos(theta1)*cos(theta4)*sin(theta2) - sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)),                                                                                                                                                         sin(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) - cos(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)), - cos(theta6)*(sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta1)*cos(theta4)*sin(theta2)) - sin(theta6)*(cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)));
    0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cos(theta1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             sin(theta1)*sin(theta2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3),                                                                                                                                                                  sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2),                                                                                                                                                         cos(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)) - sin(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)),   cos(theta6)*(sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2)) + sin(theta6)*(cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)));
    1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         cos(theta2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                sin(theta2)*sin(theta3),                                                                                                                                                                                                                      cos(theta2)*cos(theta4) - cos(theta3)*sin(theta2)*sin(theta4),                                                                                                                                                                                                                                                     sin(theta5)*(cos(theta2)*sin(theta4) + cos(theta3)*cos(theta4)*sin(theta2)) + cos(theta5)*sin(theta2)*sin(theta3),                                                                                                                                                   cos(theta6)*(cos(theta2)*cos(theta4) - cos(theta3)*sin(theta2)*sin(theta4)) - sin(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) + cos(theta3)*cos(theta4)*sin(theta2)) - sin(theta2)*sin(theta3)*sin(theta5))];
R07 =[
    cos(theta7)*(sin(theta6)*(sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta1)*cos(theta4)*sin(theta2)) - cos(theta6)*(cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)))) + sin(theta7)*(sin(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) - cos(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3))), cos(theta7)*(sin(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) - cos(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3))) - sin(theta7)*(sin(theta6)*(sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta1)*cos(theta4)*sin(theta2)) - cos(theta6)*(cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)))), - cos(theta6)*(sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta1)*cos(theta4)*sin(theta2)) - sin(theta6)*(cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)));
- cos(theta7)*(sin(theta6)*(sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2)) - cos(theta6)*(cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)))) - sin(theta7)*(sin(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) - cos(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3))), sin(theta7)*(sin(theta6)*(sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2)) - cos(theta6)*(cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)))) - cos(theta7)*(sin(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) - cos(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3))),   cos(theta6)*(sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2)) + sin(theta6)*(cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)));
sin(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) + cos(theta3)*cos(theta4)*sin(theta2)) + cos(theta5)*sin(theta2)*sin(theta3)) - cos(theta7)*(cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) + cos(theta3)*cos(theta4)*sin(theta2)) - sin(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta2)*cos(theta4) - cos(theta3)*sin(theta2)*sin(theta4))),                                                                                                                                                                                                                                             cos(theta7)*(sin(theta5)*(cos(theta2)*sin(theta4) + cos(theta3)*cos(theta4)*sin(theta2)) + cos(theta5)*sin(theta2)*sin(theta3)) + sin(theta7)*(cos(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) + cos(theta3)*cos(theta4)*sin(theta2)) - sin(theta2)*sin(theta3)*sin(theta5)) + sin(theta6)*(cos(theta2)*cos(theta4) - cos(theta3)*sin(theta2)*sin(theta4))),                                                                                                                                                   cos(theta6)*(cos(theta2)*cos(theta4) - cos(theta3)*sin(theta2)*sin(theta4)) - sin(theta6)*(cos(theta5)*(cos(theta2)*sin(theta4) + cos(theta3)*cos(theta4)*sin(theta2)) - sin(theta2)*sin(theta3)*sin(theta5))];


J0E =[
    1, 0, 0, 0, 0,   sin(phi)*(69*sin(theta1)*sin(theta3) - (7287*cos(theta1)*sin(theta2))/20 - 69*cos(theta1) + 10*cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) + 280*cos(theta6)*(sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta1)*cos(theta4)*sin(theta2)) + 280*sin(theta6)*(cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3))) + (37429*sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)))/100 + 10*sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)) - 69*cos(theta1)*cos(theta2)*cos(theta3) - (37429*cos(theta1)*cos(theta4)*sin(theta2))/100) - cos(phi)*(69*sin(theta1) + 69*cos(theta1)*sin(theta3) + (7287*sin(theta1)*sin(theta2))/20 + 10*cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) + 280*cos(theta6)*(sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2)) + (37429*sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)))/100 + 10*sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)) + 280*sin(theta6)*(cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3))) + (37429*cos(theta4)*sin(theta1)*sin(theta2))/100 + 69*cos(theta2)*cos(theta3)*sin(theta1));
    0, 1, 0, 0, 0, - sin(phi)*(69*sin(theta1) + 69*cos(theta1)*sin(theta3) + (7287*sin(theta1)*sin(theta2))/20 + 10*cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) + 280*cos(theta6)*(sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) + cos(theta4)*sin(theta1)*sin(theta2)) + (37429*sin(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)))/100 + 10*sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3)) + 280*sin(theta6)*(cos(theta5)*(cos(theta4)*(cos(theta1)*sin(theta3) + cos(theta2)*cos(theta3)*sin(theta1)) - sin(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta1)*cos(theta3) - cos(theta2)*sin(theta1)*sin(theta3))) + (37429*cos(theta4)*sin(theta1)*sin(theta2))/100 + 69*cos(theta2)*cos(theta3)*sin(theta1)) - cos(phi)*(69*sin(theta1)*sin(theta3) - (7287*cos(theta1)*sin(theta2))/20 - 69*cos(theta1) + 10*cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) + 280*cos(theta6)*(sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) - cos(theta1)*cos(theta4)*sin(theta2)) + 280*sin(theta6)*(cos(theta5)*(cos(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)) + cos(theta1)*sin(theta2)*sin(theta4)) + sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3))) + (37429*sin(theta4)*(sin(theta1)*sin(theta3) - cos(theta1)*cos(theta2)*cos(theta3)))/100 + 10*sin(theta5)*(cos(theta3)*sin(theta1) + cos(theta1)*cos(theta2)*sin(theta3)) - 69*cos(theta1)*cos(theta2)*cos(theta3) - (37429*cos(theta1)*cos(theta4)*sin(theta2))/100);
    0, 0, 1, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0;
    0, 0, 0, 1, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0;
    0, 0, 0, 0, 1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0;
    0, 0, 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               1];

R78=[cosd(-90) 0 sind(-90);
    0 1 0;
    -sind(-90) 0 cosd(-90)];
R08=R07*R78;
if(strcmp(arm,'left'))
    Je = [RGA_6x6*J07 J0E*Jwh_6D];
elseif(strcmp(arm,'right'))
    Je = [J0E*Jwh_6D RGA_6x6*J07];
else
    disp('argument error');
    while(1);
    end
end

end